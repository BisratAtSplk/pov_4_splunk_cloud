<form theme="light" script="tokenlinks.js,crud.js">
  <label>Setup Testing</label>
  <!-- Base and Hidden Searches -->
  <search id="deleteSearch" depends="$delete_key_tok$">
    <query>
      | inputlookup setup_lookup | eval key=_key | WHERE NOT key="$delete_key_tok$" | outputlookup setup_lookup
    </query>
  </search>
  <search id="createSearchPanels" depends="$CustomerName$, $CustomerPOCEmail$, $CustomerPOCName$, $LicenseSizeGB$, $SalesEngineerEmail$, $SalesEngineerName$, $DataSources$, $UseCases$">
    <query>
      | inputlookup setup_lookup | append [stats count 
      | eval CustomerName="$CustomerName$" 
      | eval CustomerPOCEmail="$CustomerPOCEmail$" 
      | eval CustomerPOCName="$CustomerPOCName$"
      | eval LicenseSizeGB="$LicenseSizeGB$" 
      | eval SalesEngineerEmail="$SalesEngineerEmail$"
      | eval SalesEngineerName="$SalesEngineerName$"
      | eval DataSources="$DataSources$"
      | eval UseCases="$UseCases$"
      | eval Notes="$AutobahnLane$"
      | eval CreatedTime=now() 
      | convert ctime(CreatedTime) ] 
      | table CreatedTime, CustomerName, LicenseSizeGB, UseCases, DataSources, SalesEngineerName, SalesEngineerEmail, CustomerPOCName, CustomerPOCEmail, AutobahnLane
      | outputlookup setup_lookup
    </query>
  </search>
  <!-- Welcome Message to the Dashboard -->
  <!-- For testing, will remove later. Show results in KVstore to validate inputs are working properly -->
  <!--creates a hidden HTML row and panel in order to create an inline style sheet-->
  <!-- Customer Inputs -->
  <fieldset submitButton="false" autoRun="false"></fieldset>
  <row>
    <panel>
      <html>
        <h2>
          <b>Welcome to the Setup Dashboard...</b>
        </h2>
<div class="panel conf-macro output-block" data-hasbody="true" data-macro-name="panel">
<div class="panelContent">
<p>Welcome <b>$env:user_realname$</b> ! This Welcome dashboard is meant to guide you in setting up your Proof of Value experience for success! You should walk through this dashboard with your Sales Engineer or an Autobahn Engineer.</p>
<p>
              <em>Alan Ivarson, Cloud Architect</em>
            </p>
</div>
</div>
        </html>
    </panel>
    <panel>
      <html>
                <!-- Set the $show_docs$ token when the link is clicked -->
                <a href="#" class="btn-pill" data-set-token="show_docs" data-value="show">
                    Show Resource Links
                </a>
                <!-- Unset the $show_docs$ token when the link is clicked -->
                <a href="#" class="btn-pill" data-token-json="{&quot;show_docs&quot;: null}">Hide All</a>
                <!-- Unset all tokens -->
                <a href="#" class="btn-pill" data-token-json="{&quot;show_st_charts&quot;: null, &quot;show_size_charts&quot;: null, &quot;show_hosts_charts&quot;: null, &quot;show_events_charts&quot;: null, &quot;show_index_charts&quot;: null, &quot;show_fwd_charts&quot;: null, &quot;show_docs&quot;: null}">Reset Dashboard</a>
      </html>
      <html rejects="$show_docs$">
            <p>Click on one of the links above to select which visualization to show.</p>
        </html>
    </panel>
  </row>
  <row depends="$hide$">
    <panel>
      <html>
        <style>
          <!-- Table Layout and colors-->
          #kpi_table {
          border-collapse: collapse;
          width: 100%;
          table-layout: auto;
          }
          
          #kpi_table td, #kpi_table th {
            border: 1px solid #ddd;
            padding: 8px;
          }
          
          #kpi_table tr:nth-child(even){background-color: #f2f2f2;}
          
          #kpi_table tr:hover {background-color: #ddd;}
          
          #kpi_table th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #4CAF50;
            color: white;}
            
            #splk_banner {
              opacity: 1 !important;
              background: linear-gradient(80deg, #E90080 14%, #de0275 14% 22%, #e72B56 22% 25%, #de0275 50%, #f14d42 90%, #f05939 90% 93%,  #F4891a 93.1%);
              color: white !important;              
              text-align: center;              
              line-height: 120px;              
              font-size: 80px;              
              padding: 1px;              
              height: 120px;
              }
              
             <!-- Input form width--> 
            #CSSPanel{
             width:0% !important;
              }
             
            #inputCollectionPanel {
              width: 100% !important;
              }
              
            #inputFormPanel {
              width: 0% !important;
              }
              
            .panel-title{
            color:#65A637 !important;
            font-weight: bold !important;
            
        </style>
      </html>
    </panel>
  </row>
  <row>
    <panel depends="$show_docs$">
      <html>
        <p>
          <b> Resources:</b>
        </p>
        <ul>
        <li>
            <a href="https://events.splunk.com/webinar-autobahn">Take the Fast Lane to Cloud with Splunk Autobahn Webinar</a>
          </li>
          <li>
            <a href="https://docs.splunk.com/Documentation/SplunkCloud/latest/Data/Whysourcetypesmatter">Splunk Docs - Why Sourcetypes matter</a>
          </li>
                    <li>
            <a href="https://lantern.splunk.com/hc/en-us/categories/360003668094-Use-Case-Library">Splunk Use Case Library</a>
          </li>
          <p/>
          </ul>
     </html>
    </panel>
  </row>
  <row>
    <panel>
      <html>
    <h1 id="splk_banner">SETUP</h1>
</html>
    </panel>
  </row>
  <row>
    <panel>
      <title>1. Customer Name: $CustomerName$</title>
      <input type="text" token="CustomerName" searchWhenChanged="true">
        <label>Enter Customer Name</label>
        <initialValue>$CustomerName$</initialValue>
      </input>
    </panel>
    <panel>
      <title>2. Manually Add Current License</title>
      <input type="dropdown" token="LicenseSizeGB" searchWhenChanged="true">
        <label>Splunk Core in GB *</label>
        <fieldForLabel>LicenseSizeGB</fieldForLabel>
        <fieldForValue>license_core</fieldForValue>
        <search>
          <query>| inputlookup core_license.csv | fields license_core</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <choice value="0">0</choice>
        <default>0</default>
        <initialValue>0</initialValue>
      </input>
    </panel>
    <panel>
      <title>3. Customer Point of Contact Info:</title>
      <input type="text" token="CustomerPOCName" searchWhenChanged="true">
        <label>Customer Point of Contact Name</label>
        <initialValue>$CustomerPOCName$</initialValue>
      </input>
      <input type="text" token="CustomerPOCEmail" searchWhenChanged="true">
        <label>Customer Point of Contact Email</label>
        <initialValue>$CustomerPOCEmail$</initialValue>
      </input>
    </panel>
    <panel>
      <title>4. Sales Engineer Contact Info:</title>
      <input type="text" token="SalesEngineerName" searchWhenChanged="true">
        <label>Enter Sales Engineer Name</label>
        <initialValue>$SalesEngineerName$</initialValue>
      </input>
      <input type="text" token="SalesEngineerEmail" searchWhenChanged="true">
        <label>Enter Sales Engineer Email</label>
        <initialValue>$SalesEngineerEmail$</initialValue>
      </input>
    </panel>
  </row>
  <row>
    <panel>
      <title>5. POC Type (Autobahn or Custom):</title>
      <input type="text" token="AutobahnLane" searchWhenChanged="true">
        <label>Select POC Type</label>
        <initialValue>$AutobhanLane$</initialValue>
      </input>
    </panel>
    <panel>
      <title>6. Use Case Info:</title>
      <input type="multiselect" token="UseCases" searchWhenChanged="true">
        <label>Select Use Case(s):</label>
        <initialValue>$UseCases$</initialValue>
        <choice value="AWS Monitoring">AWS Monitoring</choice>
        <choice value="Brute Force">Brute Force</choice>
        <choice value="Example Use Case 3">Example Use Case 3</choice>
        <delimiter>,</delimiter>
      </input>
    </panel>
    <panel>
      <title>7. Data Source Info:</title>
      <input type="multiselect" token="DataSources" searchWhenChanged="true">
        <label>Select Data Source(s):</label>
        <initialValue>$DataSources$</initialValue>
        <choice value="aws:vpcflowlogs">aws:vpcflowlogs</choice>
        <choice value="wineventlog:security">wineventlog:security</choice>
        <choice value="pan:log">pan:log</choice>
        <delimiter>,</delimiter>
      </input>
    </panel>
  </row>
  <row>
    <panel>
      <title>Table showing tokens</title>
      <table>
        <search>
          <query>| makeresults
| eval CustomerName="$CustomerName$"
| eval CustomerPOCEmail="$CustomerPOCEmail$"
| eval CustomerPOCName="$CustomerPOCName$"
| eval LicenseSizeGB="$LicenseSizeGB$"
| eval SalesEngineerEmail="$SalesEngineerEmail$"
| eval SalesEngineerName="$SalesEngineerName$"
| eval AutobahnLane="$AutobahnLane$"
| eval DataSources="$DataSources$"
| eval UseCases="$UseCases$"
| eval CreatedTime=now() 
| convert ctime(CreatedTime) 
| table CreatedTime, CustomerName, LicenseSizeGB, UseCases, DataSources, SalesEngineerName, SalesEngineerEmail, CustomerPOCName, CustomerPOCEmail, AutobahnLane</query>
          <earliest>-24h@h</earliest>
          <latest>now</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </table>
    </panel>
  </row>
  <row>
    <panel id="inputCollectionPanel">
      <table id="inputCollectionTable">
        <title>CRUD for Setup Dashboard</title>
        <search id="inputCollectionSearch">
          <query>| inputlookup setup_lookup
| eval Delete="Delete" 
| table *, Update, Delete</query>
          <earliest>0</earliest>
          <latest></latest>
          <sampleRatio>1</sampleRatio>
        </search>
        <option name="count">10</option>
        <option name="dataOverlayMode">none</option>
        <option name="drilldown">cell</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">true</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>
</form>